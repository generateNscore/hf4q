"var argsFromMain=null;\nfunction init(prms) {argsFromMain=prms;}\n//init();\nif (argsFromMain == null) {argsFromMain=[[20, 20], [[2, 0, -2,-1], [0, 3, 1, 3]], 'off'];}\n//const rA = argsFromMain[0][0], jB=argsFromMain[0][1];\nvar pxX, pxY, bbox, dragging=false, dx=0;\n\n//const hafA=rA/2, yo=20.5, yB=yo+jB*rA, jC=jB/2, cY=yo+rA*jC, hafPI=Math.PI/2;\n//cnvs.height = yB+10, cnvs.width = yB+220;\ncnvs.width=window.innerWidth, cnvs.height=window.innerHeight-430;\nconst ch=cnvs.height, cw=cnvs.width;\nconst baseH=300, baseW=400, ballR=10;\nconst ballX=baseW-ballR, ballY=ch-20-baseH-10-ballR, ballX0=ballX;\nconst btn=argsFromMain[2];\nvar canvasImage, SubmitBtn=null;\nif (btn == 'on') {SubmitBtn={x: yB+100, y:40, w:140, h:50, color:\"#d7d\"};}\n//console.log([ch, cw]);\n\n\nfunction drawBackground() {\n  ctx.beginPath();\n  ctx.fillStyle = \"#995c00\";\n  ctx.fillRect(0,ch-20,cw-20, 20);\n\n  ctx.beginPath();\n  ctx.fillStyle = \"#94b8b8\";\n  ctx.fillRect(0, ch-20-baseH, baseW, baseH);\n\n  ctx.fillStyle=\"black\"; ctx.font = \"13px arial\"; ctx.textAlign=\"center\";\n  var x;\n  for (j=0; j<baseW-50; j+=10) {\n    ctx.beginPath();\n    ctx.strokeStyle=\"black\";\n    x = baseW+0.5-2*ballR-j;\n    ctx.moveTo(x, ch-20-baseH+3);\n    if (j%50 != 0) ctx.lineTo(x, ch-20-baseH+20);\n    else {\n      ctx.lineTo(x, ch-20-baseH+30);\n      ctx.fillText(j, x, ch-20-baseH+43);\n    }\n    ctx.stroke();\n    ctx.fillText('(mm)', 29, ch-20-baseH+41);\n  }\n\n  for (j=baseW; j<cw-20; j+=10) {\n    ctx.beginPath();\n    ctx.strokeStyle=\"black\";\n    x = 0.5+j;\n    ctx.moveTo(x, ch-23);\n    if ((j-baseW)%50 != 0) ctx.lineTo(x, ch-40);\n    else {\n      ctx.lineTo(x, ch-50);\n      ctx.fillText(j-baseW, x, ch-55);\n    }\n    ctx.stroke();\n    ctx.fillText('(mm)', 29, ch-20-baseH+41);\n  }\n\n  ctx.beginPath();\n  ctx.fillStyle = \"#cc6600\";\n  ctx.fillRect(baseW-ballR, ch-20-baseH-10, ballR, 10);\n  \n  ctx.beginPath();\n  ctx.fillStyle = \"#cc6600\";\n  ctx.fillRect(baseW-ballR, ch-20-baseH-20-2*ballR, ballR, 10);\n\n  if (SubmitBtn != null) {\n    ctx.beginPath();\n    ctx.shadowColor = \"black\";\n    ctx.shadowOffsetX = 1;\n    ctx.shadowOffsetY = 1;\n    ctx.shadowBlur = 3;\n    ctx.fillStyle=SubmitBtn.color;\n    ctx.fillRect(SubmitBtn.x-SubmitBtn.w/2,SubmitBtn.y-SubmitBtn.h/2,SubmitBtn.w,SubmitBtn.h);\n    ctx.shadowColor = \"transparent\";\n    ctx.fillStyle=\"black\"; ctx.font = \"28px arial\"; ctx.textAlign=\"center\"; \n    ctx.fillText(\"Submit\", SubmitBtn.x, SubmitBtn.y+10);\n    ctx.closePath();\n  }\n  canvasImage=ctx.getImageData(0,0,cw,ch);\n}\n\ndrawBackground();\n\n\n\nfunction onmouseup(e) {\n  e.preventDefault();\n  bbox = cnvs.getBoundingClientRect();\n  pxX=e.clientX-bbox.left*(cw/bbox.width);\n  //pxY=e.clientY-bbox.top*(ch/bbox.height);\n\n  dragging=false;\n  dx=0;\n  //start motion step #1;\n  //motion step #2;\n}\n\n\nfunction onmousedown(e) {\n  e.preventDefault();\n  bbox = cnvs.getBoundingClientRect();\n  pxX=e.clientX-bbox.left*(cw/bbox.width);\n  pxY=e.clientY-bbox.top*(ch/bbox.height);\n\n  //if (SubmitBtn != null && SubmitBtn.x-SubmitBtn.w/2<=pxX && pxX <= SubmitBtn.x+SubmitBtn.w/2 && SubmitBtn.y-SubmitBtn.h/2<=pxY && pxY <= SubmitBtn.y+SubmitBtn.h/2) {Submit();}\n\n  if (ballY-ballR<pxY && pxY<ballY+ballY && ballX-ballR<pxX && pxX<ballX+ballY) {\n    dragging=true;\n    dx=0;\n  }\n}\n\n\nfunction onmousemove(e) {\n  e.preventDefault();\n  bbox = cnvs.getBoundingClientRect();\n  pxX=e.clientX-bbox.left*(cw/bbox.width);\n  //pxY=e.clientY-bbox.top*(ch/bbox.height);\n\n  if (dragging) {\n    dx = pxX-ballX0;\n    drawAll();\n  }\n}\n\n\n\nfunction drawAll() {\n  ctx.putImageData(canvasImage,0,0);\n  \n  ctx.beginPath();\n  ctx.fillStyle = \"black\";\n  ctx.arc(ballX+dx, ballY, ballR, 0, 2*Math.PI);\n  ctx.fill();\n\n  ctx.beginPath();\n  ctx.lineWidth=2;\n  ctx.strokeStyle = \"#cc6600\";\n  ctx.moveTo(ballX0, ballY+ballR+1);\n  ctx.lineTo(ballX+dx, ballY+ballR+1);\n  ctx.arc(ballX+dx, ballY, ballR+1, Math.PI/2, 3*Math.PI/2);\n  ctx.lineTo(ballX+dx, ballY-ballR-1);\n  ctx.lineTo(ballX0, ballY-ballR-1);\n  ctx.stroke();\n  ctx.lineWidth=1;\n}\n\ncnvs.addEventListener('mouseup', onmouseup);\ncnvs.addEventListener('mousedown', onmousedown);\ncnvs.addEventListener('mousemove', onmousemove);\n\ndrawAll();"